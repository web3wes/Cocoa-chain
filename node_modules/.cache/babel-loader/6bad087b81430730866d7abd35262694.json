{"ast":null,"code":"import _regeneratorRuntime from \"/Users/wes/Downloads/supply-chain-tutorial/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/wes/Downloads/supply-chain-tutorial/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/wes/Downloads/supply-chain-tutorial/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _possibleConstructorReturn from \"/Users/wes/Downloads/supply-chain-tutorial/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/wes/Downloads/supply-chain-tutorial/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _createClass from \"/Users/wes/Downloads/supply-chain-tutorial/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/wes/Downloads/supply-chain-tutorial/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/wes/Downloads/supply-chain-tutorial/src/components/App.js\";\nimport React, { Component } from 'react';\nimport Web3 from 'web3';\nimport './App.css';\nimport Asset from '../artifacts/Asset.json';\nimport Navbar from './Navbar';\nimport Form from './Form';\nimport Main from './Main';\n\nvar App = /*#__PURE__*/function (_Component) {\n  _inherits(App, _Component);\n\n  _createClass(App, [{\n    key: \"componentWillMount\",\n    value: function () {\n      var _componentWillMount = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return this.detectAsset();\n\n              case 2:\n                _context.next = 4;\n                return this.loadWeb3();\n\n              case 4:\n                _context.next = 6;\n                return this.loadBlockchainData();\n\n              case 6:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function componentWillMount() {\n        return _componentWillMount.apply(this, arguments);\n      }\n\n      return componentWillMount;\n    }()\n  }, {\n    key: \"detectAsset\",\n    value: function () {\n      var _detectAsset = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        var urlParams, address;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                urlParams = new URLSearchParams(window.location.search);\n                address = urlParams.get('address');\n                this.setState({\n                  contractAddress: address\n                });\n\n              case 3:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function detectAsset() {\n        return _detectAsset.apply(this, arguments);\n      }\n\n      return detectAsset;\n    }()\n  }, {\n    key: \"loadWeb3\",\n    value: function () {\n      var _loadWeb = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                if (!window.ethereum) {\n                  _context3.next = 6;\n                  break;\n                }\n\n                window.web3 = new Web3(window.ethereum);\n                _context3.next = 4;\n                return window.ethereum.enable();\n\n              case 4:\n                _context3.next = 7;\n                break;\n\n              case 6:\n                if (window.web3) {\n                  window.web3 = new Web3(window.web3.currentProvider);\n                } else {\n                  window.alert('Non-Ethereum browser detected. You should consider trying MetaMask!');\n                }\n\n              case 7:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3);\n      }));\n\n      function loadWeb3() {\n        return _loadWeb.apply(this, arguments);\n      }\n\n      return loadWeb3;\n    }()\n  }, {\n    key: \"loadBlockchainData\",\n    value: function () {\n      var _loadBlockchainData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n        var accounts;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.next = 2;\n                return window.web3.eth.getAccounts();\n\n              case 2:\n                accounts = _context4.sent;\n                this.setState({\n                  account: accounts[0]\n                });\n\n                if (!this.state.contractAddress) {\n                  _context4.next = 7;\n                  break;\n                }\n\n                _context4.next = 7;\n                return this.loadAsset();\n\n              case 7:\n                this.setState({\n                  loading: false\n                });\n\n              case 8:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function loadBlockchainData() {\n        return _loadBlockchainData.apply(this, arguments);\n      }\n\n      return loadBlockchainData;\n    }()\n  }]);\n\n  function App(props) {\n    var _this;\n\n    _classCallCheck(this, App);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(App).call(this, props));\n    _this.loadAsset = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5() {\n      var contract, name, status, custodian, actions;\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              contract = new window.web3.eth.Contract(Asset.abi, _this.state.contractAddress);\n              _context5.next = 3;\n              return contract.methods.name().call();\n\n            case 3:\n              name = _context5.sent;\n              _context5.next = 6;\n              return contract.methods.status().call();\n\n            case 6:\n              status = _context5.sent;\n              _context5.next = 9;\n              return contract.methods.custodian().call();\n\n            case 9:\n              custodian = _context5.sent;\n              _context5.next = 12;\n              return contract.getPastEvents('Action', {\n                fromBlock: 0,\n                toBlock: 'latest'\n              });\n\n            case 12:\n              actions = _context5.sent;\n\n              _this.setState({\n                contract: contract,\n                name: name,\n                status: status,\n                custodian: custodian,\n                actions: actions\n              });\n\n            case 14:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5);\n    }));\n\n    _this.createAsset = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7(name) {\n        var contract;\n        return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                _this.setState({\n                  loading: true\n                });\n\n                contract = new window.web3.eth.Contract(Asset.abi);\n                contract.deploy({\n                  data: Asset.bytecode,\n                  arguments: [name]\n                }).send({\n                  from: _this.state.account\n                }).once('receipt', /*#__PURE__*/function () {\n                  var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6(receipt) {\n                    return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n                      while (1) {\n                        switch (_context6.prev = _context6.next) {\n                          case 0:\n                            _this.setState({\n                              contractAddress: receipt.contractAddress\n                            });\n\n                            _context6.next = 3;\n                            return _this.loadAsset();\n\n                          case 3:\n                            _this.setState({\n                              loading: false\n                            });\n\n                          case 4:\n                          case \"end\":\n                            return _context6.stop();\n                        }\n                      }\n                    }, _callee6);\n                  }));\n\n                  return function (_x2) {\n                    return _ref3.apply(this, arguments);\n                  };\n                }());\n\n              case 3:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7);\n      }));\n\n      return function (_x) {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    _this.sendAsset = /*#__PURE__*/function () {\n      var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee9(to) {\n        return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                _this.setState({\n                  loading: true\n                });\n\n                _this.state.contract.methods.send(to).send({\n                  from: _this.state.account\n                }).once('receipt', /*#__PURE__*/function () {\n                  var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee8(receipt) {\n                    return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n                      while (1) {\n                        switch (_context8.prev = _context8.next) {\n                          case 0:\n                            _context8.next = 2;\n                            return _this.loadAsset();\n\n                          case 2:\n                            _this.setState({\n                              loading: false\n                            });\n\n                          case 3:\n                          case \"end\":\n                            return _context8.stop();\n                        }\n                      }\n                    }, _callee8);\n                  }));\n\n                  return function (_x4) {\n                    return _ref5.apply(this, arguments);\n                  };\n                }());\n\n              case 2:\n              case \"end\":\n                return _context9.stop();\n            }\n          }\n        }, _callee9);\n      }));\n\n      return function (_x3) {\n        return _ref4.apply(this, arguments);\n      };\n    }();\n\n    _this.receiveAsset = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee11() {\n      return _regeneratorRuntime.wrap(function _callee11$(_context11) {\n        while (1) {\n          switch (_context11.prev = _context11.next) {\n            case 0:\n              _this.setState({\n                loading: true\n              });\n\n              _this.state.contract.methods.receive().send({\n                from: _this.state.account\n              }).once('receipt', /*#__PURE__*/function () {\n                var _ref7 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee10(receipt) {\n                  return _regeneratorRuntime.wrap(function _callee10$(_context10) {\n                    while (1) {\n                      switch (_context10.prev = _context10.next) {\n                        case 0:\n                          _context10.next = 2;\n                          return _this.loadAsset();\n\n                        case 2:\n                          _this.setState({\n                            loading: false\n                          });\n\n                        case 3:\n                        case \"end\":\n                          return _context10.stop();\n                      }\n                    }\n                  }, _callee10);\n                }));\n\n                return function (_x5) {\n                  return _ref7.apply(this, arguments);\n                };\n              }());\n\n            case 2:\n            case \"end\":\n              return _context11.stop();\n          }\n        }\n      }, _callee11);\n    }));\n    _this.state = {\n      account: '',\n      contractAddress: null,\n      contract: {},\n      name: '',\n      custodian: '',\n      actions: [],\n      loading: true\n    };\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"renderContent\",\n    value: function renderContent() {\n      if (this.state.loading) {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          id: \"loader\",\n          className: \"text-center\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 113,\n            columnNumber: 9\n          }\n        }, /*#__PURE__*/React.createElement(\"p\", {\n          className: \"text-center\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 11\n          }\n        }, \"Loading...\"));\n      }\n\n      if (this.state.contractAddress) {\n        return /*#__PURE__*/React.createElement(Main, {\n          name: this.state.name,\n          custodian: this.state.custodian,\n          status: this.state.status,\n          contractAddress: this.state.contractAddress,\n          actions: this.state.actions,\n          receiveAsset: this.receiveAsset,\n          sendAsset: this.sendAsset,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 121,\n            columnNumber: 9\n          }\n        });\n      } else {\n        return /*#__PURE__*/React.createElement(Form, {\n          createAsset: this.createAsset,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 133,\n            columnNumber: 9\n          }\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(Navbar, {\n        account: this.state.account,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 9\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"container-fluid mt-5\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"main\", {\n        role: \"main\",\n        className: \"col-lg-12 ml-auto mr-auto\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 13\n        }\n      }, this.renderContent()))));\n    }\n  }]);\n\n  return App;\n}(Component);\n\nexport default App;","map":{"version":3,"sources":["/Users/wes/Downloads/supply-chain-tutorial/src/components/App.js"],"names":["React","Component","Web3","Asset","Navbar","Form","Main","App","detectAsset","loadWeb3","loadBlockchainData","urlParams","URLSearchParams","window","location","search","address","get","setState","contractAddress","ethereum","web3","enable","currentProvider","alert","eth","getAccounts","accounts","account","state","loadAsset","loading","props","contract","Contract","abi","methods","name","call","status","custodian","getPastEvents","fromBlock","toBlock","actions","createAsset","deploy","data","bytecode","arguments","send","from","once","receipt","sendAsset","to","receiveAsset","receive","renderContent"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport Web3 from 'web3'\nimport './App.css';\nimport Asset from '../artifacts/Asset.json'\nimport Navbar from './Navbar'\nimport Form from './Form'\nimport Main from './Main'\n\nclass App extends Component {\n\n  async componentWillMount() {\n    await this.detectAsset()\n    await this.loadWeb3()\n    await this.loadBlockchainData()\n  }\n\n  async detectAsset() {\n    const urlParams = new URLSearchParams(window.location.search)\n    const address = urlParams.get('address')\n    this.setState({ contractAddress: address })\n  }\n\n  async loadWeb3() {\n    if (window.ethereum) {\n      window.web3 = new Web3(window.ethereum)\n      await window.ethereum.enable()\n    }\n    else if (window.web3) {\n      window.web3 = new Web3(window.web3.currentProvider)\n    }\n    else {\n      window.alert('Non-Ethereum browser detected. You should consider trying MetaMask!')\n    }\n  }\n\n  async loadBlockchainData() {\n    const accounts = await window.web3.eth.getAccounts()\n    this.setState({ account: accounts[0] })\n    if(this.state.contractAddress) {\n      await this.loadAsset()\n    }\n    this.setState({ loading: false })\n  }\n\n  constructor(props) {\n    super(props)\n    this.state = {\n      account: '',\n      contractAddress: null,\n      contract: {},\n      name: '',\n      custodian: '',\n      actions: [],\n      loading: true\n    }\n  }\n\n  loadAsset = async () => {\n    const contract = new window.web3.eth.Contract(Asset.abi, this.state.contractAddress)\n    const name = await contract.methods.name().call()\n    const status = await contract.methods.status().call()\n    const custodian = await contract.methods.custodian().call()\n    const actions = await contract.getPastEvents('Action', { fromBlock: 0, toBlock: 'latest' } )\n\n    this.setState({\n      contract,\n      name,\n      status,\n      custodian,\n      actions\n    })\n  }\n\n  createAsset = async (name) => {\n    this.setState({ loading: true })\n    const contract = new window.web3.eth.Contract(Asset.abi)\n    contract.deploy({\n      data: Asset.bytecode,\n      arguments: [name]\n    })\n    .send({\n      from: this.state.account\n    }).once('receipt', async (receipt) => {\n      this.setState({ contractAddress: receipt.contractAddress })\n      await this.loadAsset()\n      this.setState({ loading: false })\n    })\n  }\n\n  sendAsset = async (to) => {\n    this.setState({ loading: true })\n    this.state.contract.methods.send(to).send({\n      from: this.state.account\n    }).once('receipt', async (receipt) => {\n      await this.loadAsset()\n      this.setState({ loading: false })\n    })\n  }\n\n  receiveAsset = async () => {\n    this.setState({ loading: true })\n    this.state.contract.methods.receive().send({\n      from: this.state.account\n    }).once('receipt', async (receipt) => {\n      await this.loadAsset()\n      this.setState({ loading: false })\n    })\n  }\n\n  renderContent() {\n    if(this.state.loading) {\n      return(\n        <div id='loader' className='text-center'>\n          <p className='text-center'>Loading...</p>\n        </div>\n      )\n    }\n\n    if(this.state.contractAddress) {\n      return(\n        <Main\n          name={this.state.name}\n          custodian={this.state.custodian}\n          status={this.state.status}\n          contractAddress={this.state.contractAddress}\n          actions={this.state.actions}\n          receiveAsset={this.receiveAsset}\n          sendAsset={this.sendAsset}\n        />\n      )\n    } else {\n      return(\n        <Form\n          createAsset={this.createAsset}\n        />\n      ) \n    }\n  }\n\n  render() {\n    return (\n      <div>\n        <Navbar account={this.state.account} />\n        <div className='container-fluid mt-5'>\n          <div className='row'>\n            <main role='main' className=\"col-lg-12 ml-auto mr-auto\">\n              {this.renderContent()}\n            </main>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}